# æ¶ˆæ¯äº¤äº’

 

#### âœ…è¡¨æƒ…è¡¨æ€

![æ–‡æœ¬æ¡†: ç›®å‰è¡¨æƒ…è¡¨æ€ä»…æ”¯æŒåœ¨é¢‘é“å†…ä½¿ç”¨](file:///C:/Users/Administrator/AppData/Local/Temp/msohtmlclip1/01/clip_image001.gif)

##### æœºå™¨äººå‘è¡¨è¡¨æƒ…è¡¨æ€

l **è¯¦ç»†æ–‡æ¡£**

[å‘è¡¨è¡¨æƒ…è¡¨æ€ | QQæœºå™¨äººæ–‡æ¡£](https://bot.q.qq.com/wiki/develop/api/openapi/reaction/put_message_reaction.html)

##### åˆ é™¤æœºå™¨äººå‘è¡¨çš„è¡¨æƒ…è¡¨æ€

l **è¯¦ç»†æ–‡æ¡£**

[åˆ é™¤è‡ªå·±çš„è¡¨æƒ…è¡¨æ€ | QQæœºå™¨äººæ–‡æ¡£](https://bot.q.qq.com/wiki/develop/api/openapi/reaction/delete_own_message_reaction.html)

##### è·å–æ¶ˆæ¯è¡¨æƒ…è¡¨æ€çš„ç”¨æˆ·åˆ—è¡¨

l **è¯¦ç»†æ–‡æ¡£**

[æ‹‰å–è¡¨æƒ…è¡¨æ€ç”¨æˆ·åˆ—è¡¨ | QQæœºå™¨äººæ–‡æ¡£](https://bot.q.qq.com/wiki/develop/api/openapi/reaction/get_reaction_users.html)

 

##### äº‹ä»¶

###### ç”¨æˆ·å‘è¡¨

l **åŸºæœ¬æ¦‚å†µ**

ç”¨æˆ·å¯¹æ¶ˆæ¯è¿›è¡Œè¡¨æƒ…è¡¨æ€æ—¶ï¼Œè§¦å‘äº‹ä»¶é€šçŸ¥ã€‚

l **è¯¦ç»†æ–‡æ¡£**

[è¡¨æƒ…è¡¨æ€äº‹ä»¶ | QQæœºå™¨äººæ–‡æ¡£](https://bot.q.qq.com/wiki/develop/api/gateway/guild_message_reactions.html)

 

#### âœ…æ–‡å­—é“¾

æ–‡æœ¬æ¶ˆæ¯å†…åµŒçš„è“è‰²æ–‡æœ¬ï¼ŒQQ Bot æä¾›æ–‡æœ¬æ¶ˆæ¯çš„äº¤äº’èƒ½åŠ›ï¼Œå½“å¼€å‘è€…ä½¿ç”¨æŒ‡å®šçš„æ ¼å¼å‘é€æ¶ˆæ¯ï¼Œç”¨æˆ·å³å¯åœ¨æ¶ˆæ¯ä½“ä¸Šè¿›è¡Œç‚¹å‡»äº¤äº’æ“ä½œï¼Œä¾‹å¦‚@æŸäººï¼Œè·³è½¬é“¾æ¥ç­‰ã€‚
 

##### AT ç›¸å…³

ç¾¤èŠ&æ–‡å­—å­é¢‘é“ï¼Œæ”¯æŒ æ–‡æœ¬æ¶ˆæ¯ã€å›¾æ–‡æ¶ˆæ¯ã€markdownæ¶ˆæ¯ã€‚

at æŸäººï¼Œè§£æä¸º @ç”¨æˆ· æ ‡ç­¾

åµŒå…¥æ–‡æœ¬æ ¼å¼ï¼š

```
<@userid>
```

at æ‰€æœ‰äººï¼Œè§£æä¸º @æ‰€æœ‰äºº æ ‡ç­¾ï¼Œéœ€è¦æœºå™¨äººæ‹¥æœ‰å‘é€ @æ‰€æœ‰äºº æ¶ˆæ¯çš„æƒé™ï¼Œä»…åœ¨æ–‡å­—å­é¢‘é“å¯ç”¨

åµŒå…¥æ–‡æœ¬æ ¼å¼ï¼š

```
@everyone
```



##### æŒ‡ä»¤ç›¸å…³

ç›®å‰ä»…åœ¨ markdown æ”¯æŒã€‚

æ ¼å¼ï¼š

```
<cmd enter=true reply=true cmd="/å›è½¦æŒ‡ä»¤">
```

åŸç”Ÿ scheme æ ¼å¼ï¼š

```
[/å›è½¦æŒ‡ä»¤](mqqapi://aio/inlinecmd?command={urlencode('/å›è½¦æŒ‡ä»¤')}&reply=false&enter=true)
```

æ ¼å¼ï¼š

```
<cmd reply=true cmd="/å‚æ•°æŒ‡ä»¤ï¼ˆå¸¦å¼•ç”¨æœ¬æ¶ˆæ¯ï¼‰">
<cmd reply=false cmd="/å‚æ•°æŒ‡ä»¤ï¼ˆä¸å¸¦å¼•ç”¨ï¼‰">
```

åŸç”Ÿ scheme æ ¼å¼ï¼š

```
[/å‚æ•°æŒ‡ä»¤ï¼ˆå¸¦å¼•ç”¨æœ¬æ¶ˆæ¯ï¼‰](mqqapi://aio/inlinecmd?command="{urlencode('/å‚æ•°æŒ‡ä»¤ï¼ˆå¸¦å¼•ç”¨æœ¬æ¶ˆæ¯ï¼‰')"&reply=true&enter=false) 
[/å‚æ•°æŒ‡ä»¤ï¼ˆä¸å¸¦å¼•ç”¨ï¼‰](mqqapi://aio/inlinecmd?command="{urlencode('/å‚æ•°æŒ‡ä»¤ï¼ˆä¸å¸¦å¼•ç”¨ï¼‰')"&reply=false&enter=false) 
```

 

##### è·³è½¬å­é¢‘é“

ä»…é¢‘é“å¯ç”¨ï¼Œ#å­é¢‘é“ è§£æä¸º #å­é¢‘é“ æ ‡ç­¾ï¼Œç‚¹å‡»å¯ä»¥è·³è½¬è‡³å­é¢‘é“ï¼Œä»…æ”¯æŒå½“å‰é¢‘é“å†…çš„å­é¢‘é“

```
<#channel_id>
```



##### è¡¨æƒ…

ä»…é¢‘é“å¯ç”¨ï¼Œè§£æä¸ºç³»ç»Ÿè¡¨æƒ…ï¼Œå…·ä½“è¡¨æƒ…idå‚è€ƒ [Emoji åˆ—è¡¨](https://bot.q.qq.com/wiki/develop/api/openapi/emoji/model.html#emoji-åˆ—è¡¨)ï¼Œä»…æ”¯æŒtype=1çš„ç³»ç»Ÿè¡¨æƒ…ï¼Œtype=2çš„emojiè¡¨æƒ…ç›´æ¥æŒ‰å­—ç¬¦ä¸²å¡«å†™å³å¯



#### âœ…æ¶ˆæ¯æŒ‰é’®

åœ¨ markdown æ¶ˆæ¯çš„åŸºç¡€ä¸Šï¼Œæ”¯æŒæ¶ˆæ¯æœ€åº•éƒ¨æŒ‚è½½æŒ‰é’®ã€‚

#####  

##### å‘é€æ–¹å¼

ã€ç”³è¯·ä½¿ç”¨ã€‘æŒ‰é’®æ¨¡ç‰ˆï¼ŒæŒ‰é’®æ¨¡ç‰ˆæš‚æ—¶ä¸æ”¯æŒä½¿ç”¨å˜é‡å¡«å……ã€‚

```
{
    "keyboard": {
        "id": "123" // ç”³è¯·æ¨¡ç‰ˆåè·å¾—
    }
}

```

ã€å†…é‚€å¼€é€šã€‘è‡ªå®šä¹‰æŒ‰é’®

```
{
    "keyboard": {
        "content": {
            "rows": [
                {"buttons": [{button}, {button}, {button}, {button}, {button}]},
                {"buttons": [{button}, {button}, {button}, {button}, {button}]},
                {"buttons": [{button}, {button}, {button}, {button}, {button}]},
                {"buttons": [{button}, {button}, {button}, {button}, {button}]},
                {"buttons": [{button}, {button}, {button}, {button}, {button}]},
            ] // è‡ªå®šä¹‰æŒ‰é’®å†…å®¹ï¼Œæœ€å¤šå¯ä»¥å‘é€5è¡ŒæŒ‰é’®ï¼Œæ¯ä¸€è¡Œæœ€å¤š5ä¸ªæŒ‰é’®ã€‚
        }
    }
}

```



##### æ•°æ®ç»“æ„ä¸åè®®

æ¶ˆæ¯å‘é€æ¥å£ keyboard å­—æ®µå€¼æ˜¯ä¸€ä¸ª json objectï¼Œrows æ•°ç»„è¡¨ç¤ºæ¯ä¸€è¡ŒæŒ‰é’®

æ¯ä¸ª button æ˜¯ä¸€ä¸ª json objectï¼Œå…·ä½“å­—æ®µå¦‚ä¸‹ï¼š

| **å±æ€§**                          | **ç±»å‹** | **å¿…å¡«** | **è¯´æ˜**                                                     |
| --------------------------------- | -------- | -------- | ------------------------------------------------------------ |
| id                                | string   | å¦       | æŒ‰é’®IDï¼šåœ¨ä¸€ä¸ªkeyboardæ¶ˆæ¯å†…è®¾ç½®å”¯ä¸€                         |
|                                   |          |          |                                                              |
| render_data.label                 | string   | æ˜¯       | æŒ‰é’®ä¸Šçš„æ–‡å­—                                                 |
| render_data.visited_label         | string   | æ˜¯       | ç‚¹å‡»åæŒ‰é’®çš„ä¸Šæ–‡å­—                                           |
| render_data.style                 | int      | æ˜¯       | æŒ‰é’®æ ·å¼ï¼š0 ç°è‰²çº¿æ¡†ï¼Œ1 è“è‰²çº¿æ¡†                             |
|                                   |          |          |                                                              |
| action.type                       | int      | æ˜¯       | 0 è·³è½¬æŒ‰é’®ï¼šhttp æˆ–  å°ç¨‹åº å®¢æˆ·ç«¯è¯†åˆ« schem, dataå­—æ®µä¸ºé“¾æ¥  1 å›è°ƒæŒ‰é’®ï¼šå›è°ƒåå°æ¥å£,  data ä¼ ç»™åå°  2 æŒ‡ä»¤æŒ‰é’®ï¼šè‡ªåŠ¨åœ¨è¾“å…¥æ¡†æ’å…¥  @bot data |
|                                   |          |          |                                                              |
| action.permisson.type             | int      | æ˜¯       | 0 æŒ‡å®šç”¨æˆ·å¯æ“ä½œ  1 ä»…ç®¡ç†è€…å¯æ“ä½œ  2 æ‰€æœ‰äººå¯æ“ä½œ  3 æŒ‡å®šèº«ä»½ç»„å¯æ“ä½œï¼ˆä»…é¢‘é“å¯ç”¨ï¼‰ |
| action.permisson.specify_role_ids | array    | å¦       | æœ‰æƒé™çš„èº«ä»½ç»„idçš„åˆ—è¡¨ï¼ˆä»…é¢‘é“å¯ç”¨ï¼‰                         |
| action.permisson.specify_user_ids | array    | å¦       | æœ‰æƒé™çš„ç”¨æˆ·idçš„åˆ—è¡¨                                         |
|                                   |          |          |                                                              |
| data                              | string   | æ˜¯       | æ“ä½œç›¸å…³çš„æ•°æ®                                               |
|                                   |          |          |                                                              |
| at_bot_show_channel_list          | bool     | å¦       | æŒ‡ä»¤æŒ‰é’®å¯ç”¨ï¼Œå¼¹å‡ºå­é¢‘é“é€‰æ‹©å™¨ï¼Œé»˜è®¤ falseï¼ˆå·²å¼ƒç”¨ï¼‰         |
| reply                             | bool     | å¦       | æŒ‡ä»¤æŒ‰é’®å¯ç”¨ï¼ŒæŒ‡ä»¤æ˜¯å¦å¸¦å¼•ç”¨å›å¤æœ¬æ¶ˆæ¯ï¼Œé»˜è®¤ false  æ”¯æŒç‰ˆæœ¬ï¼Ÿ |
| enter                             | bool     | å¦       | æŒ‡ä»¤æŒ‰é’®å¯ç”¨ï¼Œç‚¹å‡»æŒ‰é’®åç›´æ¥è‡ªåŠ¨å‘é€ dataï¼Œé»˜è®¤ falseã€‚  æ”¯æŒç‰ˆæœ¬ï¼Ÿ |
| anchor                            | bool     | å¦       | æŒ‡ä»¤æŒ‰é’®å¯ç”¨ï¼Œè‡ªåŠ¨é”šç‚¹åˆ°é€‰å›¾å™¨ï¼Œé»˜è®¤ falseï¼Œè®¾ç½® ture åä¼šå¿½ç•¥ enter é…ç½®ã€‚  æ”¯æŒç‰ˆæœ¬ï¼Ÿ |
|                                   |          |          |                                                              |
| click_limit                       | int      | å¦       | å¯æ“ä½œç‚¹å‡»çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸é™                                   |
| unsupport_tips                    | string   | æ˜¯       | å®¢æˆ·ç«¯ä¸æ”¯æŒæœ¬actionçš„æ—¶å€™ï¼Œå¼¹å‡ºçš„toastæ–‡æ¡ˆ                  |

ç¤ºä¾‹

```
{
  "rows": [
    {
      "buttons": [
        {
          "id": "1",
          "render_data": {
            "label": "â¬…ï¸ä¸Šä¸€é¡µ",
            "visited_label": "â¬…ï¸ä¸Šä¸€é¡µ"
          },
          "action": {
            "type": 1,
            "permission": {
              "type": 1,
              "specify_role_ids": [
                "1",
                "2",
                "3"
              ]
            },
            "click_limit": 10,
            "unsupport_tips": "å…¼å®¹æ–‡æœ¬",
            "data": "data",
            "at_bot_show_channel_list": true
          }
        },
        {
          "id": "2",
          "render_data": {
            "label": "â¡ï¸ä¸‹ä¸€é¡µ",
            "visited_label": "â¡ï¸ä¸‹ä¸€é¡µ"
          },
          "action": {
            "type": 1,
            "permission": {
              "type": 1,
              "specify_role_ids": [
                "1",
                "2",
                "3"
              ]
            },
            "click_limit": 10,
            "unsupport_tips": "å…¼å®¹æ–‡æœ¬",
            "data": "data",
            "at_bot_show_channel_list": true
          }
        }
      ]
    },
    {
      "buttons": [
        {
          "id": "3",
          "render_data": {
            "label": "ğŸ“… æ‰“å¡ï¼ˆ5ï¼‰",
            "visited_label": "ğŸ“… æ‰“å¡ï¼ˆ5ï¼‰"
          },
          "action": {
            "type": 1,
            "permission": {
              "type": 1,
              "specify_role_ids": [
                "1",
                "2",
                "3"
              ]
            },
            "click_limit": 10,
            "unsupport_tips": "å…¼å®¹æ–‡æœ¬",
            "data": "data",
            "at_bot_show_channel_list": true
          }
        }
      ]
    }
  ]
}

```



##### äº‹ä»¶

###### ç‚¹å‡»å›è°ƒæŒ‰é’®

l **åŸºæœ¬æ¦‚å†µ**

| åŸºæœ¬     |                            |
| -------- | -------------------------- |
| intents  | 1<<26                      |
| äº‹ä»¶ç±»å‹ | INTERACTION_CREATE         |
| è§¦å‘åœºæ™¯ | ç”¨æˆ·ç‚¹å‡»äº†æ¶ˆæ¯ä½“çš„å›è°ƒæŒ‰é’® |
| æƒé™è¦æ±‚ | æ— ç‰¹æ®Šè¦æ±‚                 |
| æ¨é€æ–¹å¼ | Websocket                  |

l **äº‹ä»¶å­—æ®µ**

| **å±æ€§**                   | **ç±»å‹** | **è¯´æ˜**                                                    |
| -------------------------- | -------- | ----------------------------------------------------------- |
| id                         | string   | å¹³å°æ–¹äº‹ä»¶ IDï¼Œå¯ä»¥ç”¨äºè¢«åŠ¨æ¶ˆæ¯å‘é€                         |
| type                       | int      | æŒ‰é’®äº‹ä»¶å›ºå®šæ˜¯ 11                                           |
| chat_type                  | int      | æ¶ˆæ¯å†…å®¹                                                    |
| timestamp                  | string   | æ¶ˆæ¯ç”Ÿäº§æ—¶é—´                                                |
| guild_id                   | string   | é¢‘é“çš„ openid                                               |
| channel_id                 | string   | æ–‡å­—å­é¢‘é“çš„ openid                                         |
| group_open_id              | string   | ç¾¤èŠçš„ openid                                               |
| chat_type                  | int      | ç›®å‰åªæœ‰ç¾¤å’Œå•èŠæœ‰è¯¥å­—æ®µï¼Œ1 ç¾¤èŠï¼Œ2 å•èŠï¼Œ  åç»­åŠ å…¥ 3 é¢‘é“ |
| data.resoloved.button_data | string   | æ“ä½œæŒ‰é’®çš„dataå­—æ®µå€¼ã€åœ¨å‘é€æŒ‰é’®æ—¶è§„åˆ’ã€‘                    |
| data.resoloved.button_id   | string   | æ“ä½œæŒ‰é’®çš„idå­—æ®µå€¼ã€åœ¨å‘é€æŒ‰é’®æ—¶è§„åˆ’ã€‘                      |
| data.resoloved.user_id     | string   | æ“ä½œçš„ç”¨æˆ·openid                                            |
| data.resoloved.message_id  | string   | æ“ä½œçš„æ¶ˆæ¯id                                                |
| version                    | int      | é»˜è®¤1                                                       |
| application_id             | string   | æœºå™¨äººçš„appid                                               |
|                            |          |                                                             |

l **äº‹ä»¶ç¤ºä¾‹**

```
// Websocket
{
    "op": 0,
    "s": 4,
    "t": "INTERACTION_CREATE",
    "id": "INTERACTION_CREATE:b68a29b3-2373-434d-ab7e-76638506237c",
    "d": {
        "application_id": "102041818",
        "chat_type": 2,
        "data": {
            "resolved": {
                "button_data": "å›è°ƒæŒ‰é’®",
                "button_id": "21",
                "user_id": "E4F4AEA33253A2797FB897C50B81D7ED"
            },
            "type": 11
        },
        "id": "30540ff7-9d8f-4737-83f1-e116ce6afa8b",
        "type": 11,
        "version": 1
    }
}

```

l **å…¶ä»–è¯´æ˜**

ç”±äº websocket æ¨é€äº‹ä»¶æ˜¯å•å‘çš„ï¼Œå¼€å‘è€…æ”¶åˆ°äº‹ä»¶ä¹‹åï¼Œéœ€è¦è¿›è¡Œä¸€æ¬¡â€œå›åº”â€ï¼Œå‘ŠçŸ¥QQåå°ï¼Œäº‹ä»¶å·²ç»æ”¶åˆ°ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¼šä¸€ç›´å¤„äºloadingçŠ¶æ€ï¼Œç›´åˆ°è¶…æ—¶ã€‚

å›åº”çš„ openapi æ¥å£

l **è¯·æ±‚**

| åŸºæœ¬         |                                |
| ------------ | ------------------------------ |
| HTTP URL     | /interactions/{interaction_id} |
| HTTP Method  | PUT                            |
| æ¥å£é¢‘ç‡é™åˆ¶ |                                |

l **è·¯å¾„å‚æ•°**

| **å±æ€§**       | **ç±»å‹** | **å¿…å¡«** | **è¯´æ˜**         |
| -------------- | -------- | -------- | ---------------- |
| interaction_id | string   | æ˜¯       | ä¸Šè¿°äº‹ä»¶ä¸­è·å¾—ã€‚ |

l **è¯·æ±‚å‚æ•°**

| **å±æ€§** | **ç±»å‹** | **å¿…å¡«** | **è¯´æ˜**                                                     |
| -------- | -------- | -------- | ------------------------------------------------------------ |
| code     | int      | æ˜¯       | 0   æˆåŠŸ  1   æ“ä½œå¤±è´¥  2   æ“ä½œé¢‘ç¹  3   é‡å¤æ“ä½œ  4   æ²¡æœ‰æƒé™  5   ä»…ç®¡ç†å‘˜æ“ä½œ |

l **è¿”å›å‚æ•°**

| **å±æ€§** | **ç±»å‹** | **è¯´æ˜** |
| -------- | -------- | -------- |
|          |          |          |

l **é”™è¯¯ç **

| **é”™è¯¯ç ** | **é”™è¯¯ç å–å€¼** | **è§£å†³æ–¹æ¡ˆ** |
| ---------- | -------------- | ------------ |
| 0          | ok             |              |

 